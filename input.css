@tailwind base;
@tailwind components;
@tailwind utilities;

/* Custom utilities for the AI UI */
@layer utilities {
  .ai-msg {
    max-width: 92%;
    width: 100%;
  }
  .ai-msg-user { background: linear-gradient(180deg, rgb(31, 41, 55), rgb(17, 24, 39)); border: 1px solid rgb(55, 65, 81); }
  .ai-msg-assistant {
    /* Modern subtle glassy gradient */
    background: linear-gradient(180deg, rgba(9,11,15,0.9), rgba(8,10,14,0.94));
    border: 1px solid rgba(120,126,140,0.18);
    box-shadow: 0 1px 0 rgba(255,255,255,0.03) inset, 0 16px 30px rgba(0,0,0,0.22);
    backdrop-filter: blur(8px);
  }

  /* Tweak internal content indents without removing bubble padding */
  .ai-msg-assistant .prose-sm {
    /* tighten default paragraph margin-left a touch (keeping 0) */
  }
  .ai-msg-assistant .prose-sm ul,
  .ai-msg-assistant .prose-sm ol {
    padding-left: 1.15rem; /* slightly smaller bullet/number indent */
  }
  .ai-msg-assistant .prose-sm li > ul,
  .ai-msg-assistant .prose-sm li > ol {
    padding-left: 1rem; /* nested lists slightly tighter */
  }

  .ai-typing {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem; /* 4px */
    margin-bottom: 0.25rem; /* 4px */
  }

  .ai-dot {
    width: 0.375rem;  /* 6px */
    height: 0.375rem; /* 6px */
    border-radius: 9999px;
    background-color: rgb(156 163 175); /* gray-400 for dark bg */
    opacity: 0.4;
    animation: ai-dot-pulse 1.2s infinite ease-in-out;
  }

  .ai-dot:nth-child(2) { animation-delay: 0.2s; }
  .ai-dot:nth-child(3) { animation-delay: 0.4s; }

  .ai-panel {
    /* Contemporary neutral: charcoal base with warm/cool micro-gradients */
    background:
      radial-gradient(1000px 500px at -20% -10%, rgba(255, 111, 97, 0.06), rgba(0,0,0,0)),
      radial-gradient(900px 500px at 120% -20%, rgba(88, 121, 255, 0.05), rgba(0,0,0,0)),
      linear-gradient(180deg, rgba(10,12,16,0.98), rgba(8,10,14,0.98));
    border: 1px solid rgba(120,126,140,0.18);
    box-shadow: 0 20px 50px rgba(0,0,0,0.45), inset 0 1px 0 rgba(255,255,255,0.03);
  }

  .ai-panel--floating {
    border-radius: 0.875rem;
    box-shadow: 0 20px 40px rgba(0,0,0,0.45), 0 0 0 1px rgba(255,255,255,0.04) inset;
    pointer-events: auto;
  }

  .ai-drag-handle {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 28px;
    margin: 0; /* flush with top and sides */
    border-bottom: 1px solid rgba(148,163,184,0.2);
    border-radius: 0.875rem 0.875rem 0 0; /* rounded only at top */
    background: linear-gradient(180deg, rgba(2,8,23,1), rgba(2,8,23,0.85));
    cursor: grab;
  }
  .ai-drag-handle.dragging { cursor: grabbing; }

  .ai-drag-icon { width: 22px; height: 14px; fill: rgba(148,163,184,0.8); }

  .ai-panel-body {
    padding: 0.75rem 1rem 1rem 1rem;
  }

  /* Prevent horizontal scroll caused by panel when floating */
  html, body { overflow-x: hidden !important; }

  /* Messages scroller and panel sizing */
  .ai-msgs {
    max-height: min(60vh, 640px);
    overflow-y: auto;
    overscroll-behavior: contain;
  }
  .ai-msgs > * { flex: 0 0 auto; }
}

@keyframes ai-dot-pulse {
  0%, 80%, 100% { opacity: 0.2; transform: translateY(0); }
  40% { opacity: 1; transform: translateY(-1px); }
}
